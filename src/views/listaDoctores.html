<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= title %>
    </title>

    <%- include("./partials/head.html") %>

</head>

<body>

<%- include("./partials/header2.html") %>

    <div style="padding-left: 30px;padding-right: 30px; padding-top: 30px;">
        <input id="searchbar" class="searchbargray-vertical" autocomplete="off" onkeyup="searchFilter()" type="text"\n name="search" placeholder="Busca algun doctor">
    </div>

    <div class="card-grid-vertical" id="containerEspecial">
      
    </div>


    <!-- Modal -->
    <div class="modal" id="myModal" style="overflow-y:auto; background:rgba(0, 0, 0, 0.5);" onclick="document.getElementById('myModal').style.display = 'none';">
        <div class="modal-dialog modal-dialog-centered modal-xl" style="background-color: transparent;">
            <!-- Modal content-->
            <div class="modal-content" style="background-color: transparent;">

                <div class="modal-body" style="background-color: white;border-radius: 10px;" id="modalbodyId">
                    <div style="min-width: 100% ;background-color: white; border-radius: 10px;">
                      <div class="contentModal">
                        <p id="nombreDoctor" class="nombreModal">Dr. Roberto Alejandro Carlos <br> Moctezuma Velazquez</p>
                        <p id="especialidadDoctor" class="especialidadModal">Ginecologia y Obstetria</p>
                        <p class="consultorio-extension"> <i class='fas fa-map-marker-alt' style='font-size:20px; color: #0071BB;'></i> Consultorio: <span id="consultorioDoctor" class="consultorio-extension-bold">150</span></p>
                        <p class="consultorio-extension"> <i class='fas fa-phone' style='font-size:20px;color: #0071BB;'></i> Extension: <span id="extensionDoctor" class="consultorio-extension-bold">4350</span></p>
                      </div>
                      <div id="containerQR" class="contentQR">
                        
                      </div>
                    </div>
                </div>
            </div>
        
        </div>
    </div>

</body>

<script type="text/javascript">
    var idleTime = 0;
    $(document).ready(function () {
        console.log("prueba")
        // Increment the idle time counter every minute.
        var idleInterval = setInterval(timerIncrement, 60000); // 1 minute

        // Zero the idle timer on mouse movement.
        $(this).mousemove(function (e) {
            idleTime = 0;
        });
        $(this).keypress(function (e) {
            idleTime = 0;
        });
    });

    function timerIncrement() {
        idleTime = idleTime + 1;
        if (idleTime > 1) { // 20 minutes
            window.location.replace("/publicidad");
        }
    }
</script>

<script>

    function modalshow(nombre,apellido,especialidad,consultorio,extension,qr) {
        console.log("prueba");
        document.getElementById('nombreDoctor').innerHTML=nombre+'<br>'+apellido
        document.getElementById('especialidadDoctor').innerHTML=especialidad
        document.getElementById('consultorioDoctor').innerHTML=consultorio
        document.getElementById('extensionDoctor').innerHTML=extension
        document.getElementById('containerQR').innerHTML='<image src="'+qr+'" class="imageQR">'
        document.getElementById("myModal").style.display = "block";
    }

    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const especia = urlParams.get('especialidad');

    var masterData ='<%= JSON.stringify(objQuery) %>'
    masterData = masterData.replaceAll('&#34;','"')
    masterData = JSON.parse(masterData)
    var FilterJson = masterData

    if(especia != "Todos"){
        FilterJson = masterData.filter(x => x.especialidad === especia);
        masterData = masterData.filter(x => x.especialidad === especia);
    }

    for (Element in FilterJson){
        //document.getElementById('containerEspecial').innerHTML += '<div class="card-style-vertical-2" onclick="modalshow(&#39'+FilterJson[Element].nombre+'&#39,&#39'+FilterJson[Element].apellido+'&#39,&#39'+FilterJson[Element].especialidad+'&#39,&#39'+FilterJson[Element].consultorio+'&#39,&#39'+FilterJson[Element].extension+'&#39,&#39'+FilterJson[Element].qr+'&#39)"><div class="card-content-2"><p class="textDoctors-vertical">'+FilterJson[Element].nombre+' <br> '+FilterJson[Element].apellido+'</p><p class="textDoctors-vertical">'+FilterJson[Element].especialidad+'</p><p class="textDoctors-vertical">'+FilterJson[Element].consultorio+'</p><p class="textDoctors-vertical">'+FilterJson[Element].torre+'</p></div></div>';
        document.getElementById('containerEspecial').innerHTML += '<div class="card-style-vertical-2"> <div class="card-content-vertical-2"> <img src="/images/directorio-medico.jpg" class="imageVerticalCard"><p class="nameDoctor-vertical">'+FilterJson[Element].nombre+' <br> '+FilterJson[Element].apellido+' </p><p class="especialidadDoctor-vertical">'+FilterJson[Element].especialidad+'</p><hr style="margin-top: 0;"/><p class="consultorio-extension-vertical"> <i class="fas fa-map-marker-alt" style="font-size:20px; color: #0071BB;""></i> Consultorio: <span class="consultorio-extension-bold-vertical">'+FilterJson[Element].consultorio+'</span></p><p class="consultorio-extension-vertical"> <i class="fas fa-phone" style="font-size:20px;color: #0071BB;""></i> Extension: <span class="consultorio-extension-bold-vertical">'+FilterJson[Element].extension+'</span></p><p class="buttonVerMas" onclick="modalshow(&#39'+FilterJson[Element].nombre+'&#39,&#39'+FilterJson[Element].apellido+'&#39,&#39'+FilterJson[Element].especialidad+'&#39,&#39'+FilterJson[Element].consultorio+'&#39,&#39'+FilterJson[Element].extension+'&#39,&#39'+FilterJson[Element].qr+'&#39)">ver mas</p></div></div>'
    }

    function searchFilter(){
        let text = document.getElementById('searchbar').value
        if(text) {
        const newData = masterData.filter((item) => {
            const itemData = item.especialidad ? item.especialidad.toUpperCase() : ''.toUpperCase();
            const itemData2 = item.nombre ? item.nombre.toUpperCase() : ''.toUpperCase();
            const itemData3 = item.apellido ? item.apellido.toUpperCase() : ''.toUpperCase();
            const textData = text.toUpperCase();
            return itemData.indexOf(textData) > -1 || itemData2.indexOf(textData) > -1 || itemData3.indexOf(textData) > -1;
        });
        document.getElementById('containerEspecial').innerHTML =''
        for (Element in newData){
            document.getElementById('containerEspecial').innerHTML += '<div class="card-style-vertical-2"> <div class="card-content-vertical-2"> <img src="/images/directorio-medico.jpg" class="imageVerticalCard"><p class="nameDoctor-vertical">'+newData[Element].nombre+' <br> '+newData[Element].apellido+' </p><p class="especialidadDoctor-vertical">'+newData[Element].especialidad+'</p><hr style="margin-top: 0;"/><p class="consultorio-extension-vertical"> <i class="fas fa-map-marker-alt" style="font-size:20px; color: #0071BB;""></i> Consultorio: <span class="consultorio-extension-bold-vertical">'+newData[Element].consultorio+'</span></p><p class="consultorio-extension-vertical"> <i class="fas fa-phone" style="font-size:20px;color: #0071BB;""></i> Extension: <span class="consultorio-extension-bold-vertical">'+newData[Element].extension+'</span></p><p class="buttonVerMas" onclick="modalshow(&#39'+newData[Element].nombre+'&#39,&#39'+newData[Element].apellido+'&#39,&#39'+newData[Element].especialidad+'&#39,&#39'+newData[Element].consultorio+'&#39,&#39'+newData[Element].extension+'&#39,&#39'+newData[Element].qr+'&#39)">ver mas</p></div></div>';
            }
        } else {
        document.getElementById('containerEspecial').innerHTML =''
        for (Element in masterData){
            document.getElementById('containerEspecial').innerHTML += '<div class="card-style-vertical-2"> <div class="card-content-vertical-2"> <img src="/images/directorio-medico.jpg" class="imageVerticalCard"><p class="nameDoctor-vertical">'+masterData[Element].nombre+' <br> '+masterData[Element].apellido+' </p><p class="especialidadDoctor-vertical">'+masterData[Element].especialidad+'</p><hr style="margin-top: 0;"/><p class="consultorio-extension-vertical"> <i class="fas fa-map-marker-alt" style="font-size:20px; color: #0071BB;""></i> Consultorio: <span class="consultorio-extension-bold-vertical">'+masterData[Element].consultorio+'</span></p><p class="consultorio-extension-vertical"> <i class="fas fa-phone" style="font-size:20px;color: #0071BB;""></i> Extension: <span class="consultorio-extension-bold-vertical">'+masterData[Element].extension+'</span></p><p class="buttonVerMas" onclick="modalshow(&#39'+masterData[Element].nombre+'&#39,&#39'+masterData[Element].apellido+'&#39,&#39'+masterData[Element].especialidad+'&#39,&#39'+masterData[Element].consultorio+'&#39,&#39'+masterData[Element].extension+'&#39,&#39'+masterData[Element].qr+'&#39)">ver mas</p></div></div>';
            }
        }
    }
</script>

</html>